<html>
<head>
<link rel="stylesheet" href = "./CSS/font-awesome-4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="./CSS/index.css">
<script src = "https://cdn.jsdelivr.net/npm/vue@2.5.16/dist/vue.js"></script>
<script src = "./components/board-spaces.js"></script>
</head>
<body>
<div class="board">
    <div class="row" v-for="(row, i) in board">
        <board-space v-for = "(space, j) in row" :value = "space" :position = "[i,j]" @makeMove = "makemove"></board-space>
    </div>
</div>
<script>
    var vue = new Vue({
        el: '.board',
        data: {
            board: [
                [0, 0, 0], 
                [0, 0, 0], 
                [0, 0, 0]
            ],
            currentPlayer: 1
        },
        methods: {
            makemove(position){
                console.log (position);
                var x = position[0];
                var y = position[1];
                var newBoard = Array.from(this.board)
                if (newBoard[x][y] !== 0) {
                    return;
                }
                newBoard[x][y] = this.currentPlayer;
                this.board = newBoard;
                if (this.currentPlayer === 1) {
                    this.currentPlayer = 2;
                }
                else {
                    this.currentPlayer = 1;
                }
                setTimeout(() => {
                   this.checkwin(); 
                }, 200);
            },
            checkwin() {
                var box1 = this.board[0][0]
                var box2 = this.board[0][1]
                var box3 = this.board[0][2]
                var box4 = this.board[1][0]
                var box5 = this.board[1][1]
                var box6 = this.board[1][2]
                var box7 = this.board[2][0]
                var box8 = this.board[2][1]
                var box9 = this.board[2][2]

                var winner = null;

                    // The X Team
                if ((box1 === 1) && (box2 === 1) && (box3 === 1)) {
                    winner = 1;
                }
                if ((box4 === 1) && (box5 === 1) && (box6 === 1)) {
                    winner = 1;
                    }
                if ((box7 === 1) && (box8 === 1) && (box9 === 1)) {
                    winner = 1;
                    }
                if ((box1 === 1) && (box4 === 1) && (box7 === 1)) {
                    winner = 1;
                    }
                if ((box2 === 1) && (box5 === 1) && (box8 === 1)) {
                    winner = 1;
                    }
                if ((box3 === 1) && (box6 === 1) && (box9 === 1)) {
                    winner = 1;
                    }
                if ((box1 === 1) && (box5 === 1) && (box9 === 1)) {
                    winner = 1;
                    }
                if ((box3 === 1) && (box5 === 1) && (box7 === 1)) {
                    winner = 1;
                    }
                // The O Team
                if ((box1 === 2) && (box2 === 2) && (box3 === 2)) {
                    winner = 2;
                    }
                if ((box4 === 2) && (box5 === 2) && (box6 === 2)) {
                    winner = 2;
                    }
                if ((box7 === 2) && (box8 === 2) && (box9 === 2)) {
                    winner = 2;
                    }
                if ((box1 === 2) && (box4 === 2) && (box7 === 2)) {
                    winner = 2;
                    }
                if ((box2 === 2) && (box5 === 2) && (box8 === 2)) {
                    winner = 2;
                    }
                if ((box3 === 2) && (box6 === 2) && (box9 === 2)) {
                    winner = 2;
                    }
                if ((box1 === 2) && (box5 === 2) && (box9 === 2)) {
                    winner = 2;
                    }
                if ((box3 === 2) && (box5 === 2) && (box7 === 2)) {
                    winner = 2;
                    }

                if (winner == null) {
                    return
                } else {
                    alert("Player " + winner + " wins!")
                    this.resetBoard()
                }
            },
            resetBoard() {
                this.currentPlayer = 1;
                this.board = [
                    [0,0,0],
                    [0,0,0],
                    [0,0,0]
                ]
            }
        }
    })
</script>
</body>
</html>